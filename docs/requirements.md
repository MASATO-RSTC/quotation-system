### 見積書システム - 要件定義ドキュメント

#### 1. システム概要

本システムは、エンジニア派遣における見積書作成業務を効率化するためのWebアプリケーションです。複雑な単価計算ロジック（時給・月給、各種割増・控除、丸め処理など）を自動化し、データの一元管理と運用ルールの統一を目指します。

#### 2. 基本情報（全契約種別で共通の入力項目）

以下の項目は、すべての見積書で入力必須となります。

*   **見積書No.**
*   **作成日** (デフォルトで現在日付、変更可能)
*   **有効期限** (作成日の1ヶ月後が自動設定)
*   **弊社の問い合わせ先** (デフォルト値設定、フォーム最下部に配置)
*   **スタッフ氏名**
*   **企業名**
*   **部署名**
*   **担当者氏名**
*   **業務内容**
*   **請求単価** (時給または月給の基本単価)
*   **契約開始日**
*   **契約終了日**
*   **契約種別**
*   **特記事項** (見積書に記載する自由記述の補足事項)

#### 3. 計算ルール（共通）

##### 3.1. 丸め処理

*   **単価の丸め単位:** 1円、10円、100円などから選択。
*   **丸め方法:** 「切り捨て」「切り上げ」「四捨五入」から選択。

##### 3.2. 精算処理

*   **精算単位:** 15分、30分などから選択。
*   **精算丸め:** 「切り捨て」「切り上げ」「四捨五入」から選択。

#### 4. 契約種別ごとの詳細仕様

##### 4.1. 時給

*   **計算ロジック:**
    *   基本となる請求単価に対して、以下の割増率を掛けて各種割増単価を算出します。
        *   普通残業: 1.25倍
        *   深夜手当: 0.25倍
        *   法定休日出勤: 1.35倍
        *   法定外休日出勤: 1.25倍
        *   60時間超過: 1.50倍
    *   **割増率の調整:** 上記の各割増率は、ユーザーが任意で調整可能です。

##### 4.2. 月時（上限あり下限あり）

*   **入力項目（すべて必須）**
    *   **契約期間:** 開始日・終了日
    *   **月額のご請求単価:** 数値入力（例：¥850,000）
    *   **上限時間（h）:** 月内の最大稼働時間（例：180）
    *   **下限時間（h）:** 月内の保障最低稼働時間（例：140）
    *   **超過単価の算出方法（選択式）**
        *   上限割（単価 ÷ 上限時間）
        *   下限割（単価 ÷ 下限時間）
        *   中央割（単価 ÷ 平均時間）
        *   任意時間割（単価 ÷ 任意時間）
            *   この場合、ユーザーは別途「任意時間（数値）」を入力する
    *   **控除単価の算出方法（選択式）**
        *   上限割／下限割／中央割／任意時間割（超過と別に選択可）
    *   **超過単価の割増係数（任意）**
        *   例：1.25、1.5 など
        *   指定があれば「計算後の超過単価 × 割増係数」で表示
        *   ※控除単価には割増係数は適用しない
    *   **丸め設定**
        *   単価の丸め単位（例：1円・10円・100円）
        *   丸め方法（例：切り捨て／切り上げ／四捨五入）
    *   **精算条件**
        *   精算単位（例：15分）
        *   精算丸め方法（例：切り捨て）
*   **その他割増項目（深夜手当など）**
    *   入力があった場合、超過単価を基準に算出。

#### 5. UI/UXに関する考慮事項

*   **動的なフォーム表示:** 選択された「契約種別」に応じて、関連する入力項目のみが表示されるようにします。
*   **入力バリデーション:** 各入力項目に対して適切なバリデーションを実装します。
*   **リアルタイム計算結果表示:** 入力値の変更に応じて、計算結果がリアルタイムで更新・表示されるようにします。

#### 6. PDF出力仕様

##### 6.1. 時給の場合
*   （省略）

##### 6.2. 月時（上限あり下限あり）の場合
*   **契約期間:** 2025年6月1日 〜 2025年6月30日（日本語表記）
*   **時間幅:** 140h〜180h
*   **ご請求単価:** ¥850,000（日本語カンマ区切り）
*   **超過単価:** 計算ロジックに基づく値。割増係数が指定されていれば適用。
*   **控除単価:** 計算ロジックに基づく値（割増なし）
*   **割増項目（深夜手当など）:** 割増率の入力がない場合は、「–」で表示。入力がある場合は金額を表示。
*   **特記事項:** 以下の内容を自動出力
    *   「※精算単位は15分、切り捨て。」
    *   「※金額は100円単位、四捨五入。」
