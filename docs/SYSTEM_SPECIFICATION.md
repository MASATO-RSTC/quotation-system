# 見積書作成システム仕様書兼要件定義ドキュメント

## 1. システム概要

本システムは、エンジニア派遣における見積書作成業務を効率化するためのWebアプリケーションです。複雑な単価計算ロジック（時給・月給、各種割増・控除、丸め処理など）を自動化し、データの一元管理と運用ルールの統一を目指します。

## 2. 見積書入力フォーム (`src/app/page.tsx`)

### 2.1. フォームの構成と項目

フォームは以下のセクションで構成される。

- **基本情報**
- **顧客情報**
- **スタッフ・契約情報**
  - `契約種別` (ドロップダウン選択: 「時給」, 「月時（上限あり下限あり）」, 「月時（上限あり下限なし）」, 「月時（上限なし下限あり）」, etc.)
  - `月給単価` (数値入力, 必須) - **月時契約選択時のみ表示**
  - `上限時間 (h)` (数値入力, 必須) - **上限時間を含む月時契約で表示**
  - `下限時間 (h)` (数値入力, 必須) - **下限時間を含む月時契約で表示**
  - `超過単価の算出基準` - **上限時間を含む月時契約で表示**
  - `控除単価の算出基準` - **下限時間を含む月時契約で表示**
  - `割増係数 (超過単価のみ)` - **上限時間を含む月時契約で表示**
- **割増率設定**
  - `普通残業` (数値入力) - **時給契約選択時のみ表示**
  - `深夜手当` (数値入力) - **時給、または上限時間のある月時契約で表示**
  - `法定休日出勤` (数値入力) - **時給、または上限時間のある月時契約で表示**
  - `法定外休日出勤` (数値入力) - **時給、または上限時間のある月時契約で表示**
  - `60時間超過` (数値入力) - **時給、または上限時間のある月時契約で表示**
- **丸め・精算設定**
- **計算結果**
  - `超過単価` - **上限時間を含む契約で表示**
  - `控除単価` - **下限時間を含む契約で表示**
- **特記事項**
- **発行元**

## 3. 計算ロジック (`src/utils/calculations.ts`)

- **超過単価の算出方法**: 上限時間を含む契約の場合に計算。
- **控除単価の算出方法**: 下限時間を含む契約の場合に計算。
- **各種割増単価（深夜手当など）**: 時給契約の場合は「ご請求単価」、月時契約の場合は「超過単価」を基準に計算される。

## 4. PDF出力 (`src/utils/generateQuotationPdf.ts`)

- **明細テーブル**:
    - **月時（上限あり下限あり）契約**: 月給単価、時間幅（例: 140h 〜 180h）、超過単価、控除単価、各種割増単価を表示。
    - **月時（上限あり下限なし）契約**: 月給単価、時間幅（例: 下限なし〜180h）、超過単価、各種割増単価を表示。
    - **月時（上限なし下限あり）契約**: 月給単価、時間幅（例: 140h〜上限なし）、控除単価を表示。

## 6. 契約種別ごとの詳細仕様

### 6.1. 時給

### 6.2. 月時契約

#### 6.2.1. 月時（上限あり下限あり）
*   **概要:** 上限と下限を設けた契約形態。
*   **入力項目:** `月給単価`, `上限時間`, `下限時間`, `超過単価の算出基準`, `控除単価の算出基準`, `割増係数`, `各種割増率`

#### 6.2.2. 月時（上限あり下限なし）
*   **概要:** 上限のみを設けた契約形態。
*   **入力項目:** `月給単価`, `上限時間`, `超過単価の算出基準`, `割増係数`, `各種割増率`

#### 6.2.3. 月時（上限なし下限あり）
*   **概要:** 下限のみを設けた契約形態。
*   **入力項目:** `月給単価`, `下限時間`, `控除単価の算出基準`
*   **備考:** 超過単価の概念がないため、深夜手当などの各種割増率設定は表示されない。
